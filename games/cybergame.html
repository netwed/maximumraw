<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybersecurity Word Search Puzzle</title>
    <style>
        /* Previous styles remain the same until .cell */
        
        .cell {
            width: 100%;
            aspect-ratio: 1;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ccc;
            background-color: #fff;
            font-weight: bold;
            font-size: clamp(12px, 3vw, 16px);
            cursor: pointer;
            transition: background-color 0.2s;
            touch-action: none;
        }

        .cell.selected {
            background-color: #e6f3ff;
            color: #4a90e2;
        }

        .cell.found {
            background-color: #d4edda;
            color: #28a745;
        }

        .cell.completed {
            animation: flash 1s infinite;
        }

        @keyframes flash {
            0% { background-color: #d4edda; }
            50% { background-color: #28a745; }
            100% { background-color: #d4edda; }
        }

        .reset-button {
            margin: 20px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4a90e2;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .reset-button:hover {
            background-color: #357abd;
        }

        /* Rest of the previous styles remain the same */
    </style>
</head>
<body>
    <h1>Cybersecurity Word Search</h1>
    <button id="resetButton" class="reset-button">Reset Game</button>
    <div class="grid" id="grid"></div>
    <div class="word-list">
        <h3>Find These Words:</h3>
        <div id="words"></div>
    </div>

    <script>
        const gridSize = 20;
        const wordsPerGame = 34;
        const allWords = [
            "ENCRYPTION", "FIREWALL", "HACKER", "PASSWORD", "MALWARE", 
            "PHISHING", "BACKDOOR", "VIRUS", "SECURITY", "TROJAN", 
            "SPYWARE", "KEYLOGGER", "PATCH", "AUTHENTICATION", "RANSOMWARE", 
            "NETWORK", "BREACH", "PROTOCOL", "INTRUSION", "ZERO",
            "HASHING", "CERTIFICATE", "SOFTWARE", "MULTIFACTOR", "EXPLOIT",
            "PRIVACY", "BOTNET", "ATTACK", "DEFENSE", "RISK",
            "VULNERABILITY", "FORENSICS", "ACCESS", "CONTROL", "PROTECTION"
        ];

        let words = [];
        let selectedCells = [];
        let foundWords = new Set();
        let startCell = null;
        let isSelecting = false;
        let gridData = null;

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function selectRandomWords() {
            const shuffledWords = shuffleArray([...allWords]);
            return shuffledWords.slice(0, wordsPerGame);
        }

        function isValidSelection(cell) {
            if (!startCell || selectedCells.length < 2) return true;
            
            const startRow = parseInt(startCell.dataset.row);
            const startCol = parseInt(startCell.dataset.col);
            const currentRow = parseInt(cell.dataset.row);
            const currentCol = parseInt(cell.dataset.col);
            
            // Calculate direction vector from start cell to second cell
            const rowDir = selectedCells.length > 1 ? 
                parseInt(selectedCells[1].dataset.row) - startRow : 
                currentRow - startRow;
            const colDir = selectedCells.length > 1 ? 
                parseInt(selectedCells[1].dataset.col) - startCol : 
                currentCol - startCol;
            
            // Normalize direction vector
            const length = Math.sqrt(rowDir * rowDir + colDir * colDir);
            const normalizedRowDir = length ? rowDir / length : 0;
            const normalizedColDir = length ? colDir / length : 0;
            
            // Check if current cell follows the same direction
            const newRowDir = currentRow - startRow;
            const newColDir = currentCol - startCol;
            const newLength = Math.sqrt(newRowDir * newRowDir + newColDir * newColDir);
            
            return Math.abs(normalizedRowDir * (newColDir / newLength) - 
                   normalizedColDir * (newRowDir / newLength)) < 0.1;
        }

        function startSelection(e) {
            e.preventDefault();
            const cell = e.target.closest('.cell');
            if (!cell) return;
            
            isSelecting = true;
            startCell = cell;
            selectedCells.forEach(cell => cell.classList.remove('selected'));
            selectedCells = [cell];
            cell.classList.add('selected');
        }

        function continueSelection(e) {
            if (!isSelecting) return;
            const cell = e.target.closest('.cell');
            if (!cell || !isValidSelection(cell)) return;
            
            if (!selectedCells.includes(cell)) {
                selectedCells.push(cell);
                cell.classList.add('selected');
            }
        }

        function handleTouchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const cell = document.elementFromPoint(touch.clientX, touch.clientY);
            if (!cell || !cell.classList.contains('cell') || !isValidSelection(cell)) return;
            
            if (!selectedCells.includes(cell)) {
                selectedCells.push(cell);
                cell.classList.add('selected');
            }
        }

        function checkGameCompletion() {
            if (foundWords.size === words.length) {
                const cells = document.querySelectorAll('.cell');
                cells.forEach(cell => cell.classList.add('completed'));
            }
        }

        function resetGame() {
            foundWords.clear();
            selectedCells = [];
            words = selectRandomWords();
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => {
                cell.classList.remove('selected', 'found', 'completed');
            });
            gridData = createGrid();
            renderGrid(gridData);
            renderWords();
        }

        // Add reset button event listener
        document.getElementById('resetButton').addEventListener('click', resetGame);

        // Rest of the previous functions remain the same
        // (createGrid, checkWord, updateWordList, renderGrid, renderWords)

        // Initialize the game
        words = selectRandomWords();
        gridData = createGrid();
        renderGrid(gridData);
        renderWords();

        // Add event listeners
        document.addEventListener('mouseup', endSelection);
        document.addEventListener('touchend', endSelection);
    </script>
</body>
</html>